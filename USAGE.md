# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–°–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤–∞—à–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ `data/org` –≤ `data/pre`:

```bash
# –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–µ—Ä–≤—ã–µ 1000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
python preprocess_data.py --max_images 1000

# –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
python preprocess_data.py

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
python preprocess_data.py --input_dir data/org --output_dir data/pre --output_size 112 --max_images 5000
```

### 2. –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏
–ü–æ—Å–ª–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:

```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (5 —ç–ø–æ—Ö, 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
python train.py --epochs 5 --num_identities 100 --batch_size 16

# –ü–æ–ª–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (50 —ç–ø–æ—Ö, –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
python train.py --epochs 50 --use_amp

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
python train.py --epochs 100 --batch_size 64 --lr 5e-4 --num_identities 5000 --use_amp
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
face_recognition/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ org/          # –ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (11050 —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ pre/          # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ checkpoints/      # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ runs/            # –õ–æ–≥–∏ TensorBoard
‚îú‚îÄ‚îÄ preprocess_data.py   # –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ train.py         # –°–∫—Ä–∏–ø—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ simple_dataset.py  # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

### –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ (`preprocess_data.py`):
- `--input_dir` - –ø–∞–ø–∫–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/org`)
- `--output_dir` - –ø–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/pre`)
- `--output_size` - —Ä–∞–∑–º–µ—Ä –≤—ã—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 112)
- `--max_images` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (`train.py`):
- `--data_dir` - –ø–∞–ø–∫–∞ —Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `data/pre`)
- `--epochs` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)
- `--batch_size` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 32)
- `--lr` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1e-3)
- `--num_identities` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
- `--embedding_size` - —Ä–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 128)
- `--loss_type` - —Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å: `arcface` –∏–ª–∏ `cosface`
- `--use_amp` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mixed Precision –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- `--val_split` - –¥–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.1)

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `runs/`. –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ TensorBoard:

```bash
tensorboard --logdir runs
```

## üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–ú–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `checkpoints/`:
- `best_checkpoint.pth` - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `last_checkpoint.pth` - –ø–æ—Å–ª–µ–¥–Ω—è—è –º–æ–¥–µ–ª—å

## üîß –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

- ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞** - –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = –ª–∏—á–Ω–æ—Å—Ç—å** - –ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** –Ω–∞ train/val
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
